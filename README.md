# å¾·èƒ½æ£®(çº¯å‡€ç‰ˆ)

> è¯¥ç‰ˆæœ¬åªæ”¯æŒ çª—å¸˜/ç¯å…·ã€‚ ç©ºè°ƒéœ€è¦æ­é… [zhong_hong](https://www.home-assistant.io/integrations/zhong_hong/) ä½¿ç”¨
> è¯¥æ–¹æ¡ˆæ—¨åœ¨å»æ‰å¾·èƒ½æ£®ä¸­æ§ä»¥åŠ mqttã€‚èµ„æ–™: æ€è·¯å¯ä»¥å‚è§è¿™é‡Œ[å¾·èƒ½æ£®æŠ€æœ¯åˆ†æ](https://docs.qq.com/doc/DQmNHdnFpVlF3UWVZ)
> è¯¥ä»£ç åœ¨ `hass-2022.10.5` ç‰ˆæœ¬ä¸‹æˆåŠŸè¿è¡Œã€‚

ç›®å‰æœ¬äººå·²äº 2022.11.04 åˆ‡æ¢è‡ªæ­¤ç‰ˆæœ¬ã€‚ä¸”å·²å°½æœ€å¤§åŠªåŠ›å®Œå–„ç›¸å…³èµ„æ–™ä»¥åŠæ–‡æ¡£ï¼ŒåŠ›æ±‚è°éƒ½å¯ä»¥ç”¨å¾—ä¸Šï¼Œæ„¿æ„å°é²œçš„æ¬¢è¿é€‚ç”¨ ğŸ‘ğŸ‘ğŸ‘ã€‚

å› ä¸ºæ²¡æœ‰æ–‡æ¡£ï¼Œæ‰€æœ‰å†…å®¹å‡ä¸ºä¸»è§‚è‡†æ–­ã€‚

å…¶ä¸­æ‰€æœ‰åè®®åˆ†æç­‰é€»è¾‘å‡ä½äº `hub.py` æ–‡ä»¶ä¸­ã€‚ä»£ç åŸºæœ¬ä¸Šéƒ½æ˜¯æŠ„è¢­ç”± [@crhan](https://github.com/crhan) å‡ å¹´å‰å¼€å‘çš„[ä¸­å¼˜ç½‘å…³](https://github.com/crhan/ZhongHongHVAC/tree/master/zhong_hong_hvac)

å¦‚æœæ‚¨ä¸ä»‹æ„ä½¿ç”¨å¾·èƒ½æ£®çš„æœåŠ¡ï¼Œä¾æ—§å¯ä»¥ä½¿ç”¨åŸæ¥çš„ [v1.0.0](https://github.com/shellvon/deocean/tree/v1.0.0) ç‰ˆæœ¬ã€‚è¯¥ç‰ˆæœ¬ä»…åœ¨ hass 2021.10.6 ç‰ˆæœ¬ä¸­æµ‹è¯•é€šè¿‡ å…·ä½“å‚è§ [ç‰ˆæœ¬ 1.0.0 å˜æ›´æ–‡æ¡£](https://github.com/shellvon/deocean/releases/tag/v1.0.0)

# å·²çŸ¥é™åˆ¶

    - ä¸çŸ¥é“æ€ä¹ˆå‘ç°ç½‘å…³ IP ä»¥åŠç«¯å£(è‡ªåŠ¨)
    - ä¸çŸ¥é“æ€ä¹ˆåˆ—å‡ºæ‰€æœ‰è®¾å¤‡ä»¥åŠåœºæ™¯(æ¨¡æ‹Ÿäº†å‘é€ï¼Œä½†å®é™…è¿”å›çš„ä¸å…¨)

ç”±äºä»¥ä¸Šé™åˆ¶ï¼Œæ‰€ä»¥å·²æœ‰çš„è®¾å¤‡/åœºæ™¯éœ€è¦äººå·¥æ·»åŠ è¿›å».å› æ­¤æä¾›äº† `register_devices` ä»¥åŠ `register_scenes` å¸®åŠ©å®Œæˆæ³¨å†Œã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦å…ˆæ³¨å†Œè®¾å¤‡ï¼Œæ‰å¯ä»¥æ³¨å†Œåœºæ™¯ã€‚å› ä¸ºåœºæ™¯æ˜¯æŒ‰ç…§è®¾å¤‡åæŸ¥æ‰¾çš„ã€‚å¦åˆ™æ²¡æœ‰è®¾å¤‡çš„åœºæ™¯ä¼šè¢«å¿½ç•¥ã€‚æ›´å¤šç»†èŠ‚å‚è§æºä»£ç ã€‚

# ä½¿ç”¨æŒ‡å—

0. å…³é—­å¾·èƒ½æ£®ç°æœ‰æœåŠ¡: `/home/deocean_v2/stop.sh` ä»¥è®©æœ¬é›†æˆå¯ä»¥æ­£å¸¸è¿
1. æŠŠ `const.example.py` æ›¿æ¢æˆ `const.py` å¹¶æŒ‰è¯´æ˜é…ç½®å¥½è®¾å¤‡/åœºæ™¯
2. å°†æœ¬é¡¹ç›®æ”¾å…¥ hass çš„ `config/custom_components` ç›®å½•ã€‚å¦‚æœæ²¡æœ‰åˆ™æ–°å»º
3. è¿›å…¥ hass åå°ï¼Œåœ¨é›†æˆä¸­æœç´¢ `deocean` æˆ–è€… `å¾·èƒ½æ£®` å³å¯

> å¾·èƒ½æ£®å…³é—­æ–¹å¼: ç¼–è¾‘ `/etc/rc.local` æ–‡ä»¶ï¼Œå°†å¾·èƒ½æ£®çš„ç›¸å…³é…ç½®å…³é—­ã€‚æ¯”å¦‚åƒå¦‚ä¸‹æ³¨é‡Š: å¦åˆ™è®¾å¤‡é‡å¯åå¯èƒ½ä¼šè®© hass å¤±æ•ˆï¼ˆå› ä¸º hass å¯åŠ¨å¯èƒ½æ›´æ…¢ï¼‰

```bash
#cd /home/deocean
#./daemon_deocean.sh &
#cd /home/deocean_v2
#./start.sh &
#./deocean_daemon.sh &
#exit 0
```

# è°ƒè¯•æ–¹å¼

ä»£ç å†…å¤§éƒ¨åˆ†æ—¥å¿—éƒ½æ˜¯ `DEBUG` ä½ å¯ä»¥å‚è€ƒ [æ­¤å¤„](https://www.home-assistant.io/integrations/logger/) é…ç½®æŸ¥çœ‹æ—¥å¿—:

```yaml
# Example configuration.yaml entry
logger:
  default: info
  logs:
    custom_components.deocean: debug
```

å¦‚æœä¸æƒ³ç›´æ¥åœ¨ `hass` å†…è°ƒè¯•ï¼Œä½ å¯ä»¥ç›´æ¥ æ‰§è¡Œ `python3 -m deocean.hub` æ‰§è¡Œç›¸å…³æµ‹è¯•ã€‚ [hub.py](./hub.py) å†…çš„ä»£ç éšæ„ä¿®æ”¹è°ƒ.

å¦‚æœä¸éœ€è¦ä»¥ç›¸å¯¹ç›®å½•å¯¼å…¥ï¼Œå¯ä»¥ä¸ä»¥ `module` å½¢å¼æ‰§è¡Œã€‚ç›´æ¥ `python3 deocean/hub.py` å³å¯ã€‚ `Python` åŸºç¡€ä¸åœ¨èµ˜è¯‰ã€‚

# å…¶ä»–æ‚¨å¯èƒ½éœ€è¦çš„

- å¾·èƒ½æ£®é…å¥—çš„ [NanoPI-Neo-Plus2](http://nanopi.io/nanopi-neo-plus2.html) ä»¥åŠ[å…¶ Wiki èµ„æ–™](https://wiki.friendlyelec.com/wiki/index.php/NanoPi_NEO_Plus2)
- é›†æˆ [HomeKit](https://www.home-assistant.io/integrations/homekit/) ä»¥è®©è‹¹æœçš„å®¶åº­ APP æ— ç¼è¡”æ¥
- é›†æˆ [ZhongHong](https://www.home-assistant.io/integrations/zhong_hong/) ä»¥è®©ç©ºè°ƒä¸€èµ·åŠ å…¥è‹¹æœå¤§å®¶åº­- é›†æˆ [SmartIR](https://github.com/smartHomeHub/SmartIR) ä»¥è®©æ”¯æŒçº¢å¤–è®¾å¤‡çš„ï¼ˆæ¯”å¦‚ç”µè§†ï¼‰åŠ å…¥è‹¹æœ
- å¦‚ä½•å¼€å‘ä¸€ä¸ª Hass æ’ä»¶çš„[å¼€å‘è€…æ–‡æ¡£](https://developers.home-assistant.io/docs/creating_component_index)
